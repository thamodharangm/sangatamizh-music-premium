/* Responsive Layout & Sidebar */

/* --- Desktop Logic (Default) --- */
.sidebar {
  width: var(--sidebar-width);
  height: 100vh;
  position: fixed;
  left: 0;
  top: 0;
  border-right: 2px solid var(--border-color);
  background: var(--bg-main);
  padding: 24px 16px;
  display: flex;
  flex-direction: column;
  z-index: 100;
  transition: all 0.3s ease;
}

.main-content {
  margin-left: var(--sidebar-width);
  width: calc(100% - var(--sidebar-width));
  padding: 2rem;
  max-width: 1200px;
  transition: all 0.3s ease;
}

.sidebar-header {
  padding: 0 12px 32px 12px;
}

.sidebar-nav {
  display: flex;
  flex-direction: column;
  gap: 8px;
  flex: 1;
}

.sidebar-footer {
  border-top: 2px solid var(--border-color);
  padding-top: 16px;
}

.mobile-logout, .mobile-login {
  display: none !important;
}

.user-info {
  padding: 0 12px;
}

.user-stats {
  display: flex;
  gap: 12px;
  margin-bottom: 12px;
  font-size: 0.9rem;
  font-weight: bold;
}

.stat-item.gems {
  color: #0ea5e9;
}
.stat-item.streak {
  color: #f59e0b;
}

.user-login-msg {
  font-size: 0.9rem;
  color: var(--text-muted);
  margin-bottom: 8px;
}

.logout-btn {
  width: 100%;
  height: 40px;
  font-size: 0.8rem;
}

.login-btn {
  width: 100%;
  text-align: center;
  text-decoration: none;
}

/* Library Header Defaults (Desktop) */
.search-input {
  width: 300px;
}

/* --- Mobile Logic (< 768px) --- */
@media (max-width: 768px) {
  /* Sidebar becomes Bottom Navigation */
  .sidebar {
    width: 100%;
    height: auto;
    bottom: 0px;
    top: auto;
    left: 0;
    border-right: none;
    border-top: 2px solid var(--border-color);
    padding: 10px 16px;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
    background: rgba(32, 47, 54, 0.95); /* Glass-like effect */
    backdrop-filter: blur(10px);
    z-index: 2000; /* Highest priority */
  }

  /* Hide Header & Footer on Mobile to save space */
  .sidebar-header,
  .sidebar-footer {
    display: none;
  }

  /* Nav becomes horizontal row */
  .sidebar-nav {
    flex-direction: row;
    justify-content: space-around;
    width: 100%;
    padding: 0;
    gap: 0;
  }

  .nav-item {
    flex-direction: column;
    padding: 8px 12px;
    margin: 0;
    font-size: 0.75rem;
    gap: 4px;
    border: none !important; /* Remove active border */
    background: transparent !important; /* Remove active bg */
  }

  /* Make icons bigger on mobile */
  .nav-item span:first-child {
    font-size: 1.5rem;
  }

  /* Active state for mobile (Text color change) */
  .nav-item.active {
    color: var(--primary);
  }

  /* Show Mobile Logout & Login */
  .mobile-logout, .mobile-login {
    display: flex !important;
    flex-direction: column !important; /* Stack icon and text */
    background: transparent;
    border: none;
    cursor: pointer;
    font-family: inherit;
    color: var(--text-muted); /* Default color */
    text-decoration: none; /* For the Link component */
    font-size: 0.75rem; /* Match other nav items */
    padding: 8px 12px; /* Match nav item padding */
    align-items: center; /* Center content */
    gap: 4px; /* Gap between icon and text */
  }
  
  .mobile-logout span:first-child, .mobile-login span:first-child {
      font-size: 1.5rem; /* Match other icons size */
  }
  
  .mobile-logout:active, .mobile-login:active {
    color: var(--secondary); /* Feedback on press */
  }

  /* Adjust Main Content */
  .main-content {
    margin-left: 0;
    width: 100%;
    padding: 1rem;
    padding-bottom: 160px; /* Space for Bottom Nav + Music Player */
  }

  /* Fix Grid Layouts on Mobile */
  .home-container {
    padding-top: 1rem;
  }

  h1 {
    font-size: 2rem;
  }

  /* Song Card Grid */
  div[style*="grid-template-columns"] {
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)) !important;
    gap: 1rem !important;
  }

  /* Music Player Positioning on Mobile */
  .glass-panel {
    bottom: 80px !important; /* Above the 60-70px nav bar */
    width: 95% !important;
    padding: 0.8rem 1rem !important;
  }

  /* --- Library Header Responsive Fixes --- */
  .library-header {
    flex-direction: column;
    align-items: flex-start !important;
    gap: 1rem;
  }
  .search-input {
    width: 100% !important; /* Full width search bar */
  }

  /* --- Admin Layout Refinements --- */

  /* Admin Tabs Fit Screen */
  .admin-tabs {
    justify-content: space-between;
    gap: 0.5rem !important;
  }
  .admin-tabs button {
    flex: 1; /* Equal width */
    padding: 0 8px !important; /* Smaller padding */
    font-size: 0.85rem !important; /* Smaller font to fit */
    white-space: nowrap;
  }

  /* 1. Admin Table -> Card View (Mobile) */
  .admin-table thead {
    display: none;
  }
  .admin-table tbody tr {
    display: block;
    margin-bottom: 1rem;
    background: var(--bg-card);
    border: 2px solid var(--border-color);
    border-radius: 12px;
    padding: 1rem;
  }
  .admin-table tbody td {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0 !important;
    text-align: right;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  }
  .admin-table tbody td:last-child {
    border-bottom: none;
    padding-top: 1rem !important;
    justify-content: flex-end; /* Actions right aligned */
  }
  .admin-table tbody td::before {
    content: attr(data-label);
    font-weight: bold;
    color: var(--text-muted);
    text-transform: uppercase;
    font-size: 0.8rem;
    text-align: left;
    margin-right: 1rem;
  }

  /* Recent Activity List Overflows */
  ul > li {
    flex-direction: column;
    align-items: flex-start !important;
    gap: 0.5rem;
  }
  ul > li > div {
    width: 100%;
  }
  ul > li h4 {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 250px;
  }
  ul > li > span {
    align-self: flex-end;
    font-size: 0.75rem;
    opacity: 0.7;
  }
}

/* 2️⃣ Small–medium phones 
   Examples: iPhone XR / 11, iPhone 12/13/14, Pixel 7,
             Samsung Galaxy S8+, A51/71, etc. */
@media (min-width: 376px) and (max-width: 430px) {
  /* Optimize Grid for 2 columns comfortably */
  div[style*="grid-template-columns"] {
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 12px !important;
  }

  /* Adjust Main Content padding */
  .main-content {
    padding: 1rem 0.75rem; /* Slightly reduced side padding */
    padding-bottom: 150px;
  }
  
  /* Music Player Fixes for this range 
     NOTE: Targeting .glass-panel as used in previous mobile block, 
     but ensure .music-player is also covered if structure changes */
  .glass-panel, .music-player {
    bottom: 90px !important; /* Clear the nav bar */
    width: 94% !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    padding: 0.6rem 0.8rem !important;
    gap: 0.5rem;
  }
  
  /* Ensure Nav Items fit */
  .nav-item {
    padding: 6px 4px;
    font-size: 0.7rem;
  }
  
  .nav-item span:first-child {
    font-size: 1.3rem;
  }
}

/* 3️⃣ Strict Mobile Layout Fixes (Hero, Trending, Spacing) */
@media (max-width: 768px) {
  
  /* Hero Section Restructure */
  .hero-section {
    flex-direction: column !important;
    align-items: flex-start !important;
    justify-content: flex-start !important;
    padding-bottom: 2rem !important;
    margin-bottom: 2rem !important;
    position: relative;
    border-bottom: 1px solid rgba(255,255,255,0.1) !important;
  }

  .hero-content {
    width: 100%;
    z-index: 2; /* Ensure text is above if overlapping */
  }

  .hero-content h1 {
    font-size: 2rem !important; /* Smaller Title */
    line-height: 1.2;
    max-width: 75%; /* Limit width to avoid hitting the image */
  }

  .hero-content p {
    font-size: 1rem !important;
    line-height: 1.4;
    margin-bottom: 1.5rem !important;
    color: var(--text-muted);
  }

  /* Optimize Buttons */
  .hero-content div {
    width: 100%;
     gap: 10px !important;
  }
  
  .hero-content button {
    flex: 1; /* Semantic full width buttons */
    padding: 0 12px !important;
    height: 42px !important;
    font-size: 0.85rem !important;
  }

  /* Fix the Mascot Image - Position Absolute Top Right */
  .hero-image {
    position: absolute;
    top: 0;
    right: 0;
    width: 80px !important; /* Much smaller */
    height: 80px !important;
    font-size: 2rem !important;
    border-width: 1px !important;
    opacity: 0.9;
  }

  /* Trending Header Alignment */
  .trending-header {
    margin-bottom: 1rem !important;
  }
  
  .trending-header h2 {
    font-size: 1.4rem !important;
  }
  
  .trending-header button {
    padding: 0 12px !important;
    height: 32px !important;
    font-size: 0.75rem !important;
  }

  /* Hide Desktop Scroll Arrows */
  .nav-arrow {
    display: none !important; 
  }

  /* Improve Horizontal Scroll Experience */
  #trending-scroll {
    padding-right: 20px; /* Peek affordance */
    scroll-snap-type: x mandatory;
  }
  
  .song-card-wrapper {
    scroll-snap-align: start;
    min-width: 150px !important; /* Ensure readable width */
  }
}

/* 4️⃣ Playlist Page Mobile Fixes */
@media (max-width: 768px) {
  .playlist-container {
    padding: 1rem !important;
  }

  /* Stack Header vertically */
  .playlist-header {
    flex-direction: column !important;
    align-items: center !important;
    text-align: center !important;
    gap: 1rem !important;
  }

  .playlist-cover {
    width: 140px !important;
    height: 140px !important;
    font-size: 3rem !important;
  }

  .playlist-info h1 {
    font-size: 2rem !important;
    margin-bottom: 0.5rem !important;
  }
  
  /* Transform Table to Cards/List */
  .playlist-container table, 
  .playlist-container thead, 
  .playlist-container tbody, 
  .playlist-container th, 
  .playlist-container td, 
  .playlist-container tr {
    display: block !important;
  }

  /* Hide Table Header */
  .playlist-container thead {
    display: none !important;
  }

  .playlist-row {
    display: flex !important;
    flex-direction: row !important;
    align-items: center !important;
    justify-content: space-between !important;
    padding: 1rem !important;
    border-bottom: 1px solid rgba(255,255,255,0.1) !important;
    gap: 12px;
  }

  /* Row Item: Index Number - Hide it or make small */
  .playlist-row td:first-child {
    display: none !important; /* Hide Index # to save space */
  }

  /* Row Item: Title & Image */
  .playlist-row td:nth-child(2) {
    padding: 0 !important;
    flex: 1; /* Take up remaining space */
  }
  
  .playlist-row td:nth-child(2) > div {
     display: flex;
     flex-direction: column !important; /* Stack image and text? No, Image left, Text right */
     align-items: flex-start !important;
     gap: 4px !important;
     position: relative;
     padding-left: 60px !important; /* Space for absolute positioned image */
     min-height: 50px;
     justify-content: center;
  }
  
  .playlist-row img {
     position: absolute;
     left: 0;
     top: 50%;
     transform: translateY(-50%);
     width: 50px !important;
     height: 50px !important;
     border-radius: 8px !important;
  }
  
  .playlist-row span { /* Title */
     font-size: 0.95rem !important;
     font-weight: 700 !important;
     line-height: 1.2;
     display: block;
     margin-bottom: 2px;
  }

  /* We previously hid the 3rd child (Artist). Let's unhide it and position it strictly or merge it visually */
  /* Actually, simply unhiding it as a block element below the title might work inside the flex container?
     No, they are separate TD elements. Converting TD to block means they stack VERTICALLY.
     Row = Flex Row.
     TD 1 (Index) = Hidden.
     TD 2 (Title+Img) = Flex 1.
     TD 3 (Artist) = ...
     TD 4 (Action) = Right.

     To stack Artist UNDER Title, we'd need them in the same container.
     Since we can't change HTML structure easily for just mobile without JS...
     
     Option B: Make the Row wrap? 
     Title (100%), Artist (100%), Button (100%).
     
     User Screenshot shows:
     [Image] [Title]
             [Artist - potentially inside title or separate line]
     [      PLAY BUTTON      ]
     
     Ah, the user screenshot shows the PLAY BUTTON is a big block at the bottom of the card!
     And the text is stacked.
  */

  /* CARD STYLE ROW FOR MOBILE */
  .playlist-row {
     flex-direction: column !important;
     align-items: flex-start !important;
     background: var(--bg-card) !important;
     margin-bottom: 1rem !important;
     border-radius: 12px !important;
     border: 1px solid var(--border-color) !important;
     padding: 1rem !important;
     gap: 1rem !important;
  }

  /* 1. Title/Image Section */
  .playlist-row td:nth-child(2) {
      width: 100%;
      border-bottom: 1px solid rgba(255,255,255,0.05); /* Separator */
      padding-bottom: 1rem !important;
      margin-bottom: 0.5rem;
  }
  
  .playlist-row td:nth-child(2) > div { /* The flex container in JS */
      flex-direction: row !important; /* Keep image left of title */
      padding-left: 0 !important;
      align-items: center !important;
      justify-content: flex-start;
  }
  
  .playlist-row img {
      position: static !important; /* Reset absolute */
      transform: none !important;
      width: 60px !important;
      height: 60px !important;
      margin-right: 12px;
  }

  /* 2. Artist Section - SHOW IT NOW */
  .playlist-row td:nth-child(3) {
      display: block !important;
      width: 100%;
      color: var(--text-muted);
      font-size: 0.9rem;
      margin-top: -12px; /* Pull closer to title section? Or just let it sit */
      padding: 0 0 1rem 0 !important; /* Spacing */
      padding-left: 72px !important; /* Align with text (60px img + 12px gap) */
  }

  /* 3. Play Button - FULL WIDTH BOTTOM */
  .playlist-row td:last-child {
      width: 100%;
      text-align: center !important;
      padding: 0 !important;
  }
  
  .playlist-row td:last-child button {
      width: 100% !important;
      background: var(--primary) !important;
      color: white !important;
      font-weight: 800 !important;
      text-transform: uppercase;
      height: 44px !important;
      box-shadow: none !important;
      border-radius: 8px !important;
  }
}

/* 5️⃣ Library Page Mobile Fixes */
@media (max-width: 768px) {
  /* Stack Title and Search Bar */
  .library-title-row {
    flex-direction: row !important; /* Keep row */
    align-items: center !important;
    gap: 1rem !important;
  }
  
  /* Title size */
  .library-title-row h1 {
     font-size: 1.8rem !important;
  }
  
  /* Search Input - Full Width / Flexible */
  .library-title-row .search-input {
      width: 100% !important;
      max-width: none !important;
      height: 40px !important;
      font-size: 0.9rem !important;
  }

  /* Make Chips horizontally scrollable smoothly */
  .category-chips {
      width: 100%;
      padding-bottom: 0 !important;
      padding-right: 16px; /* End padding */
      mask-image: linear-gradient(to right, black 90%, transparent 100%);
      -webkit-mask-image: linear-gradient(to right, black 90%, transparent 100%);
  }
  
  /* Adjust chip size slightly for touch */
  .category-chips button {
      padding: 0.5rem 1rem !important;
      font-size: 0.85rem !important;
      flex-shrink: 0;
  }
}

/* 6️⃣ Admin Dashboard Mobile Fixes */
@media (max-width: 768px) {
  /* Fix Stats Grid Layout */
  .admin-stats-grid {
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 12px !important;
  }
  
  /* Make the last card span full width if odd number */
  .admin-stat-card:last-child {
      grid-column: span 2;
  }
  
  /* Reduce Card Padding */
  .admin-stat-card {
    padding: 1rem !important;
  }
  
  /* Reduce Huge Font Sizes */
  .admin-stat-card h3 {
    font-size: 2rem !important;
  }
  
  .admin-stat-card p {
    font-size: 0.7rem !important;
  }

  /* Admin Tabs scrolling */
  .admin-tabs {
     flex-wrap: nowrap;
     overflow-x: auto;
     padding-bottom: 5px;
     justify-content: flex-start;
  }
  
  .admin-tabs button {
      flex: 0 0 auto;
      min-width: auto;
      padding: 0 16px !important;
  }
}
  
/* 7️⃣ Recent Activity Mobile Fixes */
@media (max-width: 768px) {
  .activity-item {
    flex-direction: column !important;
    align-items: flex-start !important;
    gap: 0.5rem !important;
  }
  
  .activity-left {
    width: 100%;
    /* Keep image and text side-by-side */
    display: flex !important;
    align-items: center !important; 
    gap: 12px !important;
  }
  
  .activity-text {
    flex: 1;
    min-width: 0; /* Enable truncation inside flex */
  }
  
  .activity-text h4 {
    white-space: nowrap; 
    overflow: hidden; 
    text-overflow: ellipsis; 
    max-width: 250px; /* Safe truncation width */
    font-size: 0.95rem !important;
  }
  
  .activity-date {
    align-self: flex-end;
    font-size: 0.75rem !important;
    color: var(--text-muted);
    opacity: 0.8;
  }
}
}
